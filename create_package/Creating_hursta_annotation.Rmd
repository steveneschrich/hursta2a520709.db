---
title: "Creating hursta annotation"
output: html_notebook
---

This notebook documents creating the HURSTA annotation, for the Moffitt annotation.

I use the instructions located (here)[https://bioconductor.org/packages/release/bioc/vignettes/AnnotationForge/inst/doc/SQLForge.pdf]

```{r setup}
library(RSQLite)
library(AnnotationForge)
library(tidyr)
library(dplyr)
library(readr)
```

The merck_annotation_latest file has the full data from Eric Welsh on annotation of the chip.

This is too much for the AnnotationForge, it should just be 
```
probe tab geneid
```


```{r read_annotation}
hursta_annotation<-read_tsv(file="hursta_annotation_latest.txt")

```

Filter out empty GeneID with "---"
```{r filter_empty_genes}
hursta_mapping<-hursta_annotation %>%
  	filter(`GeneID` != "---")  %>%
 	separate(`GeneID`, into="GeneMap", extra="drop") %>%
  	select(`ProbeID`, `GeneMap`)
```

Write out the results.
```{r write_mapping}
write_tsv(hursta_mapping, path="gene_map.txt", col_names=FALSE)
```


Now we can start using the DB.
We will call it: hursta2a520709
```{r make_package}
hursta_IDs <- system.file("gene_map.txt")

makeDBPackage("HUMANCHIP_DB",
              affy=FALSE,
              prefix="hursta2a520709",
              fileName="gene_map.txt",
              baseMapType="eg",
              outputDir=".",
              version="1.0.0.",
              manufacturer="Affymetrix",
              chipName="Human RSTA Custom Affymetrix 2.0 microarray [HuRSTA-2a520709]",
              manufacturerUrl = "http://www.affymetrix.com")
```


